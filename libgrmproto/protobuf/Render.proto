syntax = "proto3";

package grm.protobuf;

import "RenderConfig.proto";
import "Scene.proto";
import "Texture.proto";
import "Primitives.proto";

enum RenderDevice {
  CPU = 0;
  GPU = 1;
}

message BlobsHeader {
  message BlobLengthId {
    BlobIdentifier identifier = 1;
    uint64 blobLength = 2;
  }
  repeated BlobLengthId blobs = 1;
}

message RenderRequest {
  RenderDevice device = 1;
  Scene scene = 2;
  RenderConfig config = 3;
  BlobsHeader blobsInfo = 4;
}

message RenderError {
  string reason = 1;
}

message RequestFailure {
  string reason = 1;
}

message RenderResult {
  oneof Result {
    Texture success = 1;
    RenderError error = 2;
  }
}

message RenderResponse {
    oneof Union {
      RequestFailure invalidRequest = 1;
      RenderResult result = 2;
    }
    BlobsHeader blobsInfo = 3;
}